{"ast":null,"code":"import { createStore, applyMiddleware } from \"redux\";\nimport ReduxThunk from \"redux-thunk\";\nimport indexState from '../store/index';\nimport postState from '../store/post';\nimport comState from '../store/com';\nimport infoState from '../store/info';\nconst allState = Object.assign(indexState, postState, comState, infoState);\nconst initialState = Object.keys(allState).map(key => {\n  return {\n    [key]: allState[key]()['default']\n  };\n}); // 这里暴露出的是创建store的工厂方法\n// 每次渲染都需要重新创建一个store实例\n// 防止服务端一直复用旧实例 无法和客户端状态同步\n\nexport default function initializeStore(state) {\n  const store = createStore((state = initialState, action) => {\n    let backState = null;\n    Object.keys(allState).forEach(item => {\n      const fn = allState[item](action);\n\n      if (action.type === fn['type']) {\n        backState = fn['data'];\n      }\n    });\n    return backState ? backState : state;\n  }, Object.assign({}, initialState, state), applyMiddleware(ReduxThunk));\n  return store;\n}","map":null,"metadata":{},"sourceType":"module"}